#include <stdio.h>
#include <openssl/bn.h>
#define NBITS 128
void printBN(char *msg, BIGNUM *a)
{ /* Use BN_bn2hex(a) for hex string
	* Use BN_bn2dec(a) for decimal string */
    char *number_str = BN_bn2hex(a);
    printf("%s %s\n", msg, number_str);
    OPENSSL_free(number_str);
}
int main()
{
    BN_CTX *ctx = BN_CTX_new();

    BIGNUM *n = BN_new();
    BIGNUM *e = BN_new();
    BIGNUM *sig = BN_new();
    BIGNUM *m = BN_new();

    BN_hex2bn(&n, "D753A40451F899A616484B6727AA9349D039ED0CB0B00087F1672886858C8E63DABCB14038E2D3F5ECA50518B83D3EC5991732EC188CFAF10CA6642185CB071034B052882B1F689BD2B18F12B0B3D2E7881F1FEF387754535F80793F2E1AAAA81E4B2B0DABB763B935B77D14BC594BDF514AD2A1E20CE29082876AAEEAD764D69855E8FDAF1A506C54BC11F2FD4AF29DBB7F0EF4D5BE8E16891255D8C07134EEF6DC2DECC48725868DD821E4B04D0C89DC392617DDF6D79485D80421709D6F6FFF5CBA19E145CB5657287E1C0D4157AAB7B827BBB1E4FA2AEF2123751AAD2D9B86358C9C77B573ADD8942DE4F30C9DEEC14E627E17C0719E2CDEF1F910281933");
    BN_hex2bn(&e, "10001");
    BN_hex2bn(&sig, "8c0872b8f1c51d8ddb8fdb6d16f5a5e29a467d449356722192c39642974ca4736a488f114b2ca247a142f1d7c5facbe4dfd234179a1095ddd51b7c58e83fb3308f652b3c77b1edb457d2e4b58813dc7305a0729d69df203da59c6b27e40b19f7e558934ad8452155224ec0aea521897ccfce63cc9c9b3c76ad32a665cc9b2562b81e6b4ecba752ebfb9326b7ec00463ed56f652114e4991ac7d1b4f7f867c665a24a69106e90d7748b146a25f6dc0e2d20300a04669f7499997a89c1d5d8bae1d6d4a265e7f62ac3d1d226e68225d32f286bc72e16405663844dd44b715627ca01a0e81942cc1eb91f79e0308c8aa1e05027257db24b8cfe61d8fe152c415204");

    BN_mod_exp(m, sig, e, n, ctx);

    printBN("message:", m);

    return 0;
}

